<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'>
<meta name='author' content='Adam Morien'>
<meta name='description' content='QA Packet Validator Web App'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<title>QA Packet Validator</title>
</head>
<body>
<h2>Upload file for validation</h2>
<form method="post" action="/api/validate" enctype="multipart/form-data">
	<input type="file" name="file">
	<input type="submit" value="Upload and Validate">
</form>
<div id="download-link"></div>
<script>
document.querySelector('form').onsubmit = async function(e) {
	e.preventDefault();
	const formData = new FormData(this);
	const res = await fetch('/api/validate', {method: 'POST', body: formData});
	const data = await res.json();
	if (data.csvFilename) {
		document.getElementById('download-link').innerHTML =
			`<a href="/download/${data.csvFilename}" download>Download CSV</a>`;
		window.location.href = `/download/${data.csvFilename}`;
	} else {
		document.getElementById('download-link').innerText = 'Validation failed.';
	}
}
</script>
</body>
</html>
